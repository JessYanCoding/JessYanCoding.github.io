---
layout: post
title: Android布局性能优化
tags: [性能优化]
modified: 2016-08-23
image:
  feature: abstract-8.jpg
---

# 前言

* 我们每天都在写各种各样的布局，对于一些简单的布局我们不会考虑`性能`的问题，但是对于一些复杂且层级嵌套较深的布局有没有想过可能存在的`性能`问题呢？接下来介绍几个`Layout标签`轻松优化布局性能

## 1.Include标签

### 介绍:

* `include`标签的作用就是把一些复杂或者可重用的的页面抽取出来单独放到一个`xml`文件中，然后使用此标签导入需要到需要使用的布局中

### 用法:

```xml
<include
android:id="@+id/include"
layout="@layout/引用的布局文件" />

```

### 注意:

* `include`标签若指定了ID属性，而你的layout也定义了ID，则你的layout的ID会被覆盖
* 在`include`标签中所有的Android:layout_*都是有效的，前提是必须要写layout_width和layout_height两个属性。


## 2.Merge标签

### 介绍:

* `merge`标签的作用是合并UI布局，减少视图层级，多用于替换`FrameLayout`(`Activity｀的根布局为｀FrameLayout`)或者当一个布局包含另一个布局时（布局的根元素必须一致）

### 用法:
* 因为`Activity`的根元素是`FrameLayout`，如果你以前这样写`Activity`的布局文件:

```xml
< FrameLayout   xmlns:android = "http://schemas.android.com/apk/res/android"
     android:layout_width = "fill_parent"
     android:layout_height = "fill_parent" >
     < ImageView
         android:layout_width = "fill_parent"
         android:layout_height = "fill_parent"  
         android:scaleType = "center"
         android:src = "@drawable/sample"   />
     < TextView
         android:layout_width = "wrap_content"
         android:layout_height = "wrap_content"
         android:text = "sample"   />
</ FrameLayout >
```
* 现在你可以把根元素`FrameLayout`换成`merge`，像这样:

```xml
< merge   xmlns:android = "http://schemas.android.com/apk/res/android" >
     < ImageView
         android:layout_width = "fill_parent"
         android:layout_height = "fill_parent"  
         android:scaleType = "center"
         android:src = "@drawable/sample"   />
     < TextView
         android:layout_width = "wrap_content"
         android:layout_height = "wrap_content"
         android:text = "sample"   />
</ merge >
```
＊ 这时通过`HierarchyViewer`工具，你可以看到`FrameLayout`已经不见了

### 注意:
* 被`include`进来的布局文件可以使用`merge`标签
* 使用`merge`作为布局的根元素的时候，我们原来被`merge`替代的顶节点是不能有多余的属性的，否则`merge`实现不了.
*  `merge`只能用于`xml layout`文件的根元素
*  在代码中`inflate`一个以`merge`为根元素的
布局文件时候，你需要指定一个`ViewGroup`作为其容器，并且要设置**attachToRoot**为**true**